    SELECT
        TRAFFIC.WCEL_ID,
        TRAFFIC.rpdate,
        TRAFFIC.HSDPA_RAB建立成功率,       
        TRAFFIC.X_HSDPA_RAB建立成功率,
        TRAFFIC.Y_HSDPA_RAB建立成功率,
        TRAFFIC.REJ_HS_DSCH_RET_INT,
        TRAFFIC.REJ_HS_DSCH_RET_BGR,
        TRAFFIC.REJ_HS_DSCH_AMR_BGR,
        TRAFFIC.SETUP_FAIL_HS_DSCH_AMR_BGR,
        TRAFFIC.SETUP_FAIL_RNC_HS_DSCH_INT,
        TRAFFIC.SETUP_FAIL_IUB_MAC_D_INT,
        TRAFFIC.SETUP_FAIL_UE_HS_DSCH_INT,
        TRAFFIC.SETUP_FAIL_BTS_HS_DSCH_INT,
        TRAFFIC.SETUP_FAIL_IUB_HS_TOTAL_INT,
        TRAFFIC.SETUP_FAIL_RNC_HS_DSCH_BGR,
        TRAFFIC.SETUP_FAIL_IUB_MAC_D_BGR,
        TRAFFIC.SETUP_FAIL_UE_HS_DSCH_BGR,
        TRAFFIC.SETUP_FAIL_BTS_HS_DSCH_BGR,
        TRAFFIC.SETUP_FAIL_IUB_HS_TOTAL_BGR,
        TRAFFIC.REJ_HS_DSCH_AMR_INT,
        TRAFFIC.STP_F_HS_INTER_RNC_HHO_INT,
        TRAFFIC.STP_F_HS_INTER_RNC_HHO_BGR,
        TRAFFIC.DL_DCH_SEL_HSDPA_POWER_INT,
        TRAFFIC.DL_DCH_SEL_HSDPA_POWER_BGR,
        TRAFFIC.DCH_SEL_MAX_HSDPA_USERS_INT,
        TRAFFIC.DCH_SEL_MAX_HSDPA_USERS_BGR
            
    FROM
        (Select
            TRAFFIC.WCEL_ID,
            to_char(TRAFFIC.period_start_time,'YYYY-MM-DD-HH24') rpdate,

            ROUND(Decode(Sum(RRC.ATT_RB_SETUP_HSDPA), 0, 0, Sum(RRC.SUCC_RB_SETUP_HSDPA) /
            Sum(RRC.ATT_RB_SETUP_HSDPA))*100,2) As HSDPA_RAB建立成功率,
            
            Sum(RRC.SUCC_RB_SETUP_HSDPA) As X_HSDPA_RAB建立成功率,
            
            Sum(RRC.ATT_RB_SETUP_HSDPA) As Y_HSDPA_RAB建立成功率,
            
            Sum(TRAFFIC.REJ_HS_DSCH_RET_INT) As REJ_HS_DSCH_RET_INT,
            Sum(TRAFFIC.REJ_HS_DSCH_RET_BGR) As REJ_HS_DSCH_RET_BGR,
            Sum(TRAFFIC.REJ_HS_DSCH_AMR_BGR) As REJ_HS_DSCH_AMR_BGR,
            Sum(TRAFFIC.SETUP_FAIL_HS_DSCH_AMR_BGR) As SETUP_FAIL_HS_DSCH_AMR_BGR,
            Sum(TRAFFIC.SETUP_FAIL_RNC_HS_DSCH_INT) As SETUP_FAIL_RNC_HS_DSCH_INT,
            Sum(TRAFFIC.SETUP_FAIL_IUB_MAC_D_INT) As SETUP_FAIL_IUB_MAC_D_INT,
            Sum(TRAFFIC.SETUP_FAIL_UE_HS_DSCH_INT) As SETUP_FAIL_UE_HS_DSCH_INT,
            Sum(TRAFFIC.SETUP_FAIL_BTS_HS_DSCH_INT) As SETUP_FAIL_BTS_HS_DSCH_INT,
            Sum(TRAFFIC.SETUP_FAIL_IUB_HS_TOTAL_INT) As SETUP_FAIL_IUB_HS_TOTAL_INT,
            Sum(TRAFFIC.SETUP_FAIL_RNC_HS_DSCH_BGR) As SETUP_FAIL_RNC_HS_DSCH_BGR,
            Sum(TRAFFIC.SETUP_FAIL_IUB_MAC_D_BGR) As SETUP_FAIL_IUB_MAC_D_BGR,
            Sum(TRAFFIC.SETUP_FAIL_UE_HS_DSCH_BGR) As SETUP_FAIL_UE_HS_DSCH_BGR,
            Sum(TRAFFIC.SETUP_FAIL_BTS_HS_DSCH_BGR) As SETUP_FAIL_BTS_HS_DSCH_BGR,
            Sum(TRAFFIC.SETUP_FAIL_IUB_HS_TOTAL_BGR) As SETUP_FAIL_IUB_HS_TOTAL_BGR,
            Sum(TRAFFIC.REJ_HS_DSCH_AMR_INT) As REJ_HS_DSCH_AMR_INT,
            Sum(TRAFFIC.STP_F_HS_INTER_RNC_HHO_INT) As STP_F_HS_INTER_RNC_HHO_INT,
            Sum(TRAFFIC.STP_F_HS_INTER_RNC_HHO_BGR) As STP_F_HS_INTER_RNC_HHO_BGR,
            Sum(TRAFFIC.DL_DCH_SEL_HSDPA_POWER_INT) As DL_DCH_SEL_HSDPA_POWER_INT,
            Sum(TRAFFIC.DL_DCH_SEL_HSDPA_POWER_BGR) As DL_DCH_SEL_HSDPA_POWER_BGR,
            Sum(TRAFFIC.DCH_SEL_MAX_HSDPA_USERS_INT) As DCH_SEL_MAX_HSDPA_USERS_INT,
            Sum(TRAFFIC.DCH_SEL_MAX_HSDPA_USERS_BGR) As DCH_SEL_MAX_HSDPA_USERS_BGR
            
        From
                       NOKRWW_PS_TRAFFIC_MNC1_RAW TRAFFIC
            Inner Join NOKRWW_PS_RRC_MNC1_RAW RRC On TRAFFIC.WCEL_ID = RRC.WCEL_ID And
                                           TRAFFIC.PERIOD_START_TIME = RRC.PERIOD_START_TIME
         
        Where
            TRAFFIC.PERIOD_START_TIME >= To_Date(&start_dateTime, 'yyyy-mm-dd-hh24') And
            TRAFFIC.PERIOD_START_TIME < To_Date(&end_datetime, 'yyyy-mm-dd-hh24')
            
        Group By
            TRAFFIC.WCEL_ID,
            to_char(TRAFFIC.period_start_time,'YYYY-MM-DD-HH24')
        )  TRAFFIC 
        
    WHERE
        (HSDPA_RAB建立成功率 < 90 AND Y_HSDPA_RAB建立成功率 <> 0)

    ORDER BY
        HSDPA_RAB建立成功率 
    
   
 